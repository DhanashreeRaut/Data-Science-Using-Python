#ML algorithm

import pandas as pd

#from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split
from  sklearn.metrics import accuracy_score
from sklearn.metrics import classification_report
from sklearn.metrics import confusion_matrix

from sklearn.linear_model import LogisticRegression
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier
from sklearn.ensemble import GradientBoostingClassifier
from sklearn.neural_network import MLPClassifier
from sklearn.naive_bayes import MultinomialNB
from sklearn.naive_bayes import GaussianNB
from sklearn import svm

logr=LogisticRegression()
dt = DecisionTreeClassifier(random_state=0)
rf = RandomForestClassifier(random_state=1)
gbm = GradientBoostingClassifier(n_estimators=10)
nn = MLPClassifier(solver="lbfgs",alpha=1e-5,hidden_layer_sizes=(2,5),random_state=0)
nbm = MultinomialNB()
nbg = GaussianNB()
svm = svm.SVC()


df=pd.read_csv("C:/Users/CC-087/Documents/DR DSML intership/Dataset/IRIS.csv")
# print(df)

x=df.drop("species",axis=1)
y=df["species"]

# print(x)
# print(y)

x_train,x_test,y_train,y_test=train_test_split(x,y,random_state=0,test_size=0.3)

# print(x_train,end="\n")
# print(x_test,end="\n")
# print(y_train,end="\n")
# print(y_test)

logr.fit(x_train,y_train)
y_predLR=logr.predict(x_test)
print("Logistic Regression",accuracy_score(y_test,y_predLR))

dt.fit(x_train,y_train)
y_predDT=dt.predict(x_test)
print("Decision Tree ",accuracy_score(y_test,y_predDT))

rf.fit(x_train,y_train)
y_predRF=rf.predict(x_test)
print("Random Forest",accuracy_score(y_test,y_predRF))

gbm.fit(x_train,y_train)
y_predGBM=gbm.predict(x_test)
print("Gradient Boosting",accuracy_score(y_test,y_predGBM))

nn.fit(x_train,y_train)
y_predNN=nn.predict(x_test)
print("Neural Network",accuracy_score(y_test,y_predNN))

nbm.fit(x_train,y_train)
y_predNBM=nbm.predict(x_test)
print("Naive Bayes by MultinomialNB",accuracy_score(y_test,y_predNBM))

nbg.fit(x_train,y_train)
y_predNBG=nbg.predict(x_test)
print("Naive Bayes by GaussianNB",accuracy_score(y_test,y_predNBG))

svm.fit(x_train,y_train)
y_predSVM=svm.predict(x_test)
print("SVM",accuracy_score(y_test,y_predSVM))

#------------------OUTPUT------------------------
# Logistic Regression 0.9777777777777777
# Decision Tree  0.9777777777777777
# Random Forest 0.9777777777777777
# Gradient Boosting 0.9777777777777777
# Neural Network 0.9777777777777777
# Naive Bayes by MultinomialNB 0.6
# Naive Bayes by GaussianNB 1.0
# SVM 0.9777777777777777
